---
title: 鹏信科技
date: 2021-08-31
tags:
---



## 村民 干部

今天的面试题:
村里新来一位干部，5位村民分别听到关于这位干部的如下情况：

(1)姓莫，中年，女干部，精通会计;

(2)姓徐，中年，男干部，懂建筑设计;

(3)姓刘，青年，男干部，熟悉农业生产技术;

(4)姓吕，青年，男干部，懂建筑设计;

(5)姓莫，老年，男干部，熟悉农业生产技术。

每位村民听到的四项情况中各只有一项正确。这位新来的干部是



```
假设精通农业，则不姓刘、莫，不为青、老，不为男，
	则姓徐、吕，为中，为女
	则为徐中女、吕中女，则(1)命中2个条件，不符合
	
假设精通建筑，则不姓徐、吕，不为中、青，不为男，
	则姓刘、莫，为老，为女
	则为刘老女、莫老女，
	莫老女时，(5)命中2个条件，不符合
	刘老女时，符合
```



## 计算字符出现的次数，字符之间用分号间隔

例如HelloWorld，输出H-1;e-1;l-3;o-2;d-1

```java
public class Main {
    public static void countAndPrint(String input) {
        Map<Character, Integer> map = new LinkedHashMap<>();
        List<String> list = new ArrayList<>();
        // 计数
        for (int i = 0; i < input.length(); i++) {
            Character ch = input.charAt(i);
            if (!map.containsKey(ch)) {
                map.put(ch, 1);
            } else {
                map.put(ch, map.get(ch) + 1);
            }
        }
        // 遍历map并添加到list中
        for (Map.Entry<Character, Integer> entry : map.entrySet()) {
            list.add(entry.getKey() + "-" + entry.getValue());
        }
        String res = StringUtils.join(list, ";");
        System.out.println(res);
    }

    public static void main(String[] args) {
        countAndPrint("HelloWorld");
    }
}
```

因为要顺序的输出，所以用到LinkedHashMap

方法二：

```java
 private static void countAndPrint2(String input) {
        int len = (int) 'z';

        // 默认初始化为0
        int[] num = new int[len];
        Set<Character> set = new HashSet<>();
        List<String> list = new ArrayList<>();

        for (int i = 0; i < input.length(); i++) {
            char ch = input.charAt(i);
            num[ch] += 1;
        }

        for (int i = 0; i < input.length(); i++) {
            char ch = input.charAt(i);
            if (!set.contains(ch)) {
                list.add(ch + "-" + num[ch]);
            }
            set.add(ch);
        }
        String res = StringUtils.join(list, ";");
        System.out.println(res);
    }
```



## redis的数据类型

List、Hash、Set

```bash
# 创建并初始化
$ LPUSH list1 5 6 7 8 9
# 输出
$ LRANGE list1 0 -1
9
8
7
6
5
```

### list

list是一个栈，操作是lpush、rpush、lpop、rpop

lpush表示list push、lrange表示list range

### 字符串

```bash
$ set username naruto
$ get username
naruto

```

### hmset 表示hash multiple set

可以一次插入多个键值对

```bash
# 创建并初始化
$ hmset student01 name "naruto" age 18
# 获取键值
$ hget student01 name
```



### hset 表示hash set

与hmset相比，一次只能插入一个键值对

```bash
# 创建并初始化
$ hset student01 name "naruto"
$ hset student02 age 18
# 获取键值
$ hget student01 name
```

### set 表示无序集合

```bash
127.0.0.1:6379> sadd student_name naruto
(integer) 1
127.0.0.1:6379> sadd student_name "sasuke"
(integer) 1
127.0.0.1:6379> sadd student_name sakura
(integer) 1
127.0.0.1:6379> smembers student_name
1) "sakura"
2) "naruto"
3) "sasuke"
```

可以看到并没有按照我们添加的顺序进行打印，所以是无序集合

### zset 表示有序集合



```bash
127.0.0.1:6379> zadd roles 1 大蛇
(integer) 1
127.0.0.1:6379> zadd roles 2 八神奄
(integer) 1
127.0.0.1:6379> zadd roles 2 隆
(integer) 1
127.0.0.1:6379> zadd roles 3 草薙京
(integer) 1

127.0.0.1:6379> zrange roles 0 10
大蛇
八神奄
隆
草薙京

127.0.0.1:6379> zrange roles 0 10 withscores
大蛇
1
八神奄
2
隆
2
草薙京
3
```





## hashmap的属性

```java

int threshold;
// 存放键值对
transient Node<K,V>[] table;

The number of key-value mappings contained in this map.
transient int size;

// 是缓存
// Holds cached entrySet(). Note that AbstractMap fields are used for keySet() and values().
transient Set<Map.Entry<K,V>> entrySet;
```

threshold阈值

threshold表示当HashMap的size大于threshold时会执行resize操作。 
threshold=capacity*loadFactor

## hashmap的方法

isEmpty()

containsKey()，containsValue()

entrySet()

put()

putAll()

remove()

keys()，values()

clear()

get()



## hashmap用到的设计模式

Nodes

组合模式、代理模式



### composite

```java
package com.lin.composite;
public abstract class OrganizationComponmet {

    private String name;
    
    private String des;
    
    protected void add(OrganizationComponmet organizationComponmet) {
        throw new UnsupportedOperationException();
    }
    
    protected void remove(OrganizationComponmet organizationComponmet) {
        throw new UnsupportedOperationException();
    }

    public OrganizationComponmet(String name, String des) {
        super();
        this.name = name;
        this.des = des;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getDes() {
        return des;
    }
    public void setDes(String des) {
        this.des = des;
    }
    protected abstract void print();
       
}
```

### University

```java
package com.lin.composite;

import java.util.ArrayList;
import java.util.List;

public class University extends OrganizationComponmet{
    
    List<OrganizationComponmet> organizationComponmets = new ArrayList<OrganizationComponmet>();

    

    public University(String name, String des) {
        super(name, des);
    }
    
    @Override
    protected void add(OrganizationComponmet organizationComponmet) {
        organizationComponmets.add(organizationComponmet);
    }

    @Override
    protected void remove(OrganizationComponmet organizationComponmet) {
        organizationComponmets.remove(organizationComponmet);
    }
    
    
    @Override
    public String getDes() {
        return super.getDes();
    }
    
    @Override
        public String getName() {
            return super.getName();
        }
    
    
    @Override
    protected void print() {
    
        System.out.println("---------------------" + getName() + "--------------------");
        
        for (OrganizationComponmet organizationComponmet : organizationComponmets) {
            organizationComponmet.print();
        }
    }

    
}
```

### College

```java
package com.lin.composite;

import java.util.ArrayList;
import java.util.List;

public class College extends OrganizationComponmet{

List<OrganizationComponmet> organizationComponmets = new ArrayList<OrganizationComponmet>();

    

    public College(String name, String des) {
        super(name, des);
    }
    
    @Override
    protected void add(OrganizationComponmet organizationComponmet) {
        organizationComponmets.add(organizationComponmet);
    }

    @Override
    protected void remove(OrganizationComponmet organizationComponmet) {
        organizationComponmets.remove(organizationComponmet);
    }
    
    
    @Override
    public String getDes() {
        return super.getDes();
    }
    
    @Override
        public String getName() {
            return super.getName();
        }
    
    @Override
    protected void print() {
    
        System.out.println("---------------------" + getName() + "--------------------");
        
        for (OrganizationComponmet organizationComponmet : organizationComponmets) {
            organizationComponmet.print();
        }
    }

    
}
```

### Department

```java
package com.lin.composite;

public class Department extends OrganizationComponmet{

    public Department(String name, String des) {
        super(name, des);
    }

    @Override
    public String getDes() {
        return super.getDes();
    }
    
    @Override
        public String getName() {
            return super.getName();
        }
    
    @Override
    protected void print() {
        System.out.println(getName());
    }   
}
```



### Client

```java
package com.lin.composite;

public class Client {

    public static void main(String[] args) {
        
        OrganizationComponmet university = new University("波大", "美国大学");
        
        OrganizationComponmet college1 = new College("计算机学院", "计算机");
        OrganizationComponmet college2 = new College("中文学院", "中文");
        
        university.add(college1);
        university.add(college2);
        
        OrganizationComponmet department1 = new Department("软件工程专业", "软件");
        OrganizationComponmet department2 = new Department("大数据专业", "大数据");
        OrganizationComponmet department3 = new Department("汉语言专业", "汉语言");
        OrganizationComponmet department4 = new Department("中华文化专业", "中华文化");
        
        college1.add(department1);
        college1.add(department2);
        college2.add(department3);
        college2.add(department4);
        
        university.print();
        System.out.println("--------------------------------------------");
        college1.print();
    }
}
```

### 分析

![2257481-20210204232547114-1823326747](https://tva1.sinaimg.cn/large/008i3skNgy1gu0d705wx8j60hg069my302.jpg)

![2257481-20210204232538631-500329085](https://tva1.sinaimg.cn/large/008i3skNgy1gu0d7ab8ggj60j106eaaa02.jpg)

Map的put、putall交给AbstractHashMap实现，再交给HashMap实现，而结点的管理交给Node来实现。

### 什么是组合模式？

大部分国家的军队都采用层次结构管理。 每支部队包括几个师， 师由旅构成， 旅由团构成， 团可以继续划分为排。 最后， 每个排由一小队实实在在的士兵组成。 军事命令由最高层下达， 通过每个层级传递， 直到每位士兵都知道自己应该服从的命令。

<img src="https://tva1.sinaimg.cn/large/008i3skNgy1gu0di3rxdej60mw0poq4n02.jpg" alt="image-20210831230947643" style="zoom:33%;" />



1. **组件** （Component） 接口描述了树中简单项目和复杂项目所共有的操作。

2. **叶节点** （Leaf） 是树的基本结构， 它不包含子项目。

    一般情况下， 叶节点最终会完成大部分的实际工作， 因为它们无法将工作指派给其他部分。

3. **容器** （Container）——又名 “组合 （Composite）”——是包含叶节点或其他容器等子项目的单位。 容器不知道其子项目所属的具体类， 它只通过通用的组件接口与其子项目交互。

    容器接收到请求后会将工作分配给自己的子项目， 处理中间结果， 然后将最终结果返回给客户端。

4. **客户端** （Client） 通过组件接口与所有项目交互。 因此， 客户端能以相同方式与树状结构中的简单或复杂项目交互。

而Map也是一样，先让AbstractHashMap完成一些事情，再将剩下的任务交给HashMap完成，HashMap又将一部分任务交给Node完成，Node是容器。

## ${}和#{}的区别

#{}是预编译，${}是字符串替换



## mybatis有什么好处

* sql参数注入、返回
* 动态sql

## mybatis注入支持的数据类型

基本数据类型：整型、浮点、字符串

复杂数据类型：Map、引用

| java       | sql       |      |
| ---------- | --------- | ---- |
| String     | varchar   |      |
| Integer    | Integer   |      |
| BigDecimal | numeric   |      |
| date       | date      |      |
| calendar   | timestamp |      |
| byte[]     | blob      |      |
| Double     | double    |      |

```java
// 这里parameterType是Map
<sql id="Base_Column_List" > 
 id, car_dept_name, car_maker_name, icon,car_maker_py,hot_type 
 </sql> 
 <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" > 
 select 
 <include refid="Base_Column_List" /> 
 from common_car_make 
 where id = #{id,jdbcType=BIGINT} 
 </select> 
```



```java
// parameterType是自定义引用类型
<update id="updateByPrimaryKeySelective" parameterType="com.illuca.entity.Student" > 
 update student 
 <set > 
  <if test="studentName != null" > 
  student_name = #{studentName,jdbcType=VARCHAR}, 
  </if> 
  <if test="score != null" > 
  score = #{score,jdbcType=VARCHAR}
 </set> 
 where student_id = #{studentId,jdbcType=BIGINT} 
 </update> 
```

## 删除A中存在但B中不存在的记录

delete from A where tagetColumn not in ( select targetColumn from B)

## 网关解决什么问题？什么是熔断？

解决路由问题
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"illuca.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="illuca &#39;s Blog">
<meta property="og:type" content="website">
<meta property="og:title" content="illuca">
<meta property="og:url" content="https://illuca.github.io/index.html">
<meta property="og:site_name" content="illuca">
<meta property="og:description" content="illuca &#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="illuca">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://illuca.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>illuca</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">illuca</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2023/05/18/2013.%20Detect%20Squares/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/18/2013.%20Detect%20Squares/" class="post-title-link" itemprop="url">2013. Detect Squares</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-05-18 00:00:00 / Modified: 21:11:41" itemprop="dateCreated datePublished" datetime="2023-05-18T00:00:00+08:00">2023-05-18</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>Note:</strong></p>
<p>Pay attention to array bound. You’d better plus 1 to array size.</p>
<p>In this problem, 0&lt;=x,y&lt;=1000. So I should init array size as 1000+1;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DetectSquares</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    map&lt;<span class="keyword">int</span>, vector&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt;&gt; mapY;</span><br><span class="line">    <span class="keyword">int</span> counter[<span class="number">1001</span>][<span class="number">1001</span>]=&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; point)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pointx=point[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> pointy=point[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span>(counter[pointx][pointy] == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//only insert once</span></span><br><span class="line">            mapY[pointy].<span class="built_in">emplace_back</span>(pointx, pointy);</span><br><span class="line">        &#125;</span><br><span class="line">        counter[pointx][pointy]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; query)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> queryx=query[<span class="number">0</span>], queryy=query[<span class="number">1</span>];</span><br><span class="line">        vector&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; arrY=mapY[query[<span class="number">1</span>]];</span><br><span class="line">        <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//arry does not have duplicate items</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;arrY.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">            pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; p = arrY[i];</span><br><span class="line">            <span class="keyword">int</span> px=p.first,py=p.second;</span><br><span class="line">            <span class="keyword">int</span> edge=<span class="built_in">abs</span>(queryx-px);</span><br><span class="line">            <span class="keyword">if</span>(edge==<span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> y=queryy+edge;</span><br><span class="line">            <span class="keyword">int</span> _y=queryy-edge;</span><br><span class="line">            <span class="keyword">if</span> (y&gt;=<span class="number">0</span> &amp;&amp; y&lt;=<span class="number">1000</span> ) &#123;</span><br><span class="line">                <span class="comment">//up=[queryx,y]</span></span><br><span class="line">                <span class="comment">//upDia=[px,y]</span></span><br><span class="line">                res+= counter[px][py] * counter[queryx][y] * counter[px][y];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (_y&gt;=<span class="number">0</span> &amp;&amp; _y&lt;=<span class="number">1000</span>) &#123;</span><br><span class="line">                <span class="comment">//down=[queryx,_y]</span></span><br><span class="line">                <span class="comment">//downDia=[px,_y]   </span></span><br><span class="line">                res+= counter[px][py] * counter[queryx][_y] * counter[px][_y];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>I think it can be more clear because diagonal point is more special than point with the same x as query. And if we get the diagonal point, it is easier to express two other points.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DetectSquares</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; points;</span><br><span class="line">    <span class="keyword">int</span> counter[<span class="number">1001</span>][<span class="number">1001</span>]=&#123;&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; point)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pointX=point[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> pointY=point[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span>(counter[pointX][pointY] == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//only insert once</span></span><br><span class="line">            points.<span class="built_in">emplace_back</span>(pointX, pointY);</span><br><span class="line">        &#125;</span><br><span class="line">        counter[pointX][pointY]++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; query)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> queryX=query[<span class="number">0</span>], queryY=query[<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> res=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;[diagX, diagY]: points)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">abs</span>(diagX-queryX)!=<span class="built_in">abs</span>(diagY-queryY) || diagX-queryX==<span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//m has the same x as diag and same y as query</span></span><br><span class="line">                <span class="comment">//m(diagX, queryY)</span></span><br><span class="line">                <span class="comment">//n(queryX, diagY)</span></span><br><span class="line">                res+=counter[diagX][queryY]*counter[queryX][diagY]*counter[diagX][diagY];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2023/05/16/1055.%20Shortest%20Way%20to%20Form%20String/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/16/1055.%20Shortest%20Way%20to%20Form%20String/" class="post-title-link" itemprop="url">1055. Shortest Way to Form String</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-05-16 00:00:00" itemprop="dateCreated datePublished" datetime="2023-05-16T00:00:00+08:00">2023-05-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-05-18 21:13:01" itemprop="dateModified" datetime="2023-05-18T21:13:01+08:00">2023-05-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/shortest-way-to-form-string/description/">https://leetcode.com/problems/shortest-way-to-form-string/description/</a></p>
<p>A <strong>subsequence</strong> of a string is a new string that is formed from the original string by deleting some (can be none) of the characters without disturbing the relative positions of the remaining characters. (i.e., <code>&quot;ace&quot;</code> is a subsequence of <code>&quot;abcde&quot;</code> while <code>&quot;aec&quot;</code> is not).</p>
<p>Given two strings <code>source</code> and <code>target</code>, return <em>the minimum number of <strong>subsequences</strong> of</em> <code>source</code> <em>such that their concatenation equals</em> <code>target</code>. If the task is impossible, return <code>-1</code>.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: source = &quot;abc&quot;, target = &quot;abcbc&quot;</span><br><span class="line">Output: 2</span><br><span class="line">Explanation: The target &quot;abcbc&quot; can be formed by &quot;abc&quot; and &quot;bc&quot;, which are subsequences of source &quot;abc&quot;.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: source = &quot;abc&quot;, target = &quot;acdbc&quot;</span><br><span class="line">Output: -1</span><br><span class="line">Explanation: The target string cannot be constructed from the subsequences of source string due to the character &quot;d&quot; in target string.</span><br></pre></td></tr></table></figure>

<p><strong>Example 3:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: source = &quot;xyz&quot;, target = &quot;xzyxz&quot;</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: The target string can be constructed as follows &quot;xz&quot; + &quot;y&quot; + &quot;xz&quot;.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= source.length, target.length &lt;= 1000</code></li>
<li><code>source</code> and <code>target</code> consist of lowercase English letters.</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">shortestWay</span><span class="params">(string source, string target)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//explain subsequence. it is a special string that remain relative position in original string</span></span><br><span class="line">        <span class="comment">//we use sub of source and use them to form target</span></span><br><span class="line">        <span class="comment">//traverse target and for each target[i] try to find matched ch in source. so we need to traverse source.</span></span><br><span class="line">            <span class="comment">//traverse source</span></span><br><span class="line">                <span class="comment">//if find matched ch in source, then increase both string index and try to find next match ch</span></span><br><span class="line">            <span class="comment">//if in current loop, num of matched is 0, then return -1</span></span><br><span class="line">            <span class="comment">//otherwise i+=num of matched</span></span><br><span class="line">        <span class="keyword">int</span> loops=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;target.<span class="built_in">size</span>();)&#123;</span><br><span class="line">            <span class="keyword">int</span> matched=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;source.<span class="built_in">size</span>();j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(target[i+matched]==source[j])&#123;</span><br><span class="line">                    matched++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(matched==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                i+=matched;</span><br><span class="line">                loops++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> loops;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Beats 100% and only one submit no debug. It seems finally i grasp some trick? Amazing.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2023/05/15/1101.%20The%20Earliest%20Moment%20When%20Everyone%20Become%20Friends/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/15/1101.%20The%20Earliest%20Moment%20When%20Everyone%20Become%20Friends/" class="post-title-link" itemprop="url">1101. The Earliest Moment When Everyone Become Friends</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-05-15 00:00:00" itemprop="dateCreated datePublished" datetime="2023-05-15T00:00:00+08:00">2023-05-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-05-16 20:01:05" itemprop="dateModified" datetime="2023-05-16T20:01:05+08:00">2023-05-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>There are n people in a social group labeled from <code>0</code> to <code>n - 1</code>. You are given an array <code>logs</code> where <code>logs[i] = [timestampi, xi, yi]</code> indicates that <code>xi</code> and <code>yi</code> will be friends at the time <code>timestampi</code>.</p>
<p>Friendship is <strong>symmetric</strong>. That means if <code>a</code> is friends with <code>b</code>, then <code>b</code> is friends with <code>a</code>. Also, person <code>a</code> is acquainted with a person <code>b</code> if <code>a</code> is friends with <code>b</code>, or <code>a</code> is a friend of someone acquainted with <code>b</code>.</p>
<p>Return <em>the earliest time for which every person became acquainted with every other person</em>. If there is no such earliest time, return <code>-1</code>.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Input: logs = [[20190101,0,1],[20190104,3,4],[20190107,2,3],[20190211,1,5],[20190224,2,4],[20190301,0,3],[20190312,1,2],[20190322,4,5]], n = 6</span><br><span class="line">Output: 20190301</span><br><span class="line">Explanation: </span><br><span class="line">The first event occurs at timestamp = 20190101, and after 0 and 1 become friends, we have the following friendship groups [0,1], [2], [3], [4], [5].</span><br><span class="line">The second event occurs at timestamp = 20190104, and after 3 and 4 become friends, we have the following friendship groups [0,1], [2], [3,4], [5].</span><br><span class="line">The third event occurs at timestamp = 20190107, and after 2 and 3 become friends, we have the following friendship groups [0,1], [2,3,4], [5].</span><br><span class="line">The fourth event occurs at timestamp = 20190211, and after 1 and 5 become friends, we have the following friendship groups [0,1,5], [2,3,4].</span><br><span class="line">The fifth event occurs at timestamp = 20190224, and as 2 and 4 are already friends, nothing happens.</span><br><span class="line">The sixth event occurs at timestamp = 20190301, and after 0 and 3 become friends, we all become friends.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: logs = [[0,2,0],[1,0,1],[3,0,3],[4,1,2],[7,3,1]], n = 4</span><br><span class="line">Output: 3</span><br><span class="line">Explanation: At timestamp = 3, all the persons (i.e., 0, 1, 2, and 3) become friends.</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>2 &lt;= n &lt;= 100</code></li>
<li><code>1 &lt;= logs.length &lt;= 104</code></li>
<li><code>logs[i].length == 3</code></li>
<li><code>0 &lt;= timestampi &lt;= 109</code></li>
<li><code>0 &lt;= xi, yi &lt;= n - 1</code></li>
<li><code>xi != yi</code></li>
<li>All the values <code>timestampi</code> are <strong>unique</strong>.</li>
<li>All the pairs <code>(xi, yi)</code> occur at most one time in the input.</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findRoot</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt; &amp;parent, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// keep find next util next is -1</span></span><br><span class="line">        <span class="keyword">int</span> curr = x;</span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> next = parent[curr];</span><br><span class="line">            <span class="keyword">if</span> (next == <span class="number">-1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> curr;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                curr = next;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">bool</span> <span class="title">compare</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp;v1, vector&lt;<span class="keyword">int</span>&gt;&amp;v2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> v1[<span class="number">0</span>] &lt; v2[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">earliestAcq</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; &amp;logs, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// init a nodes array, every time connect two parent, we firstly find root of i, and parent[root]=j</span></span><br><span class="line">        <span class="comment">// remove j from leaves</span></span><br><span class="line">        <span class="comment">// if all leaves have same root, then return time. </span></span><br><span class="line">        <span class="comment">// otherwise, keep traversing logs</span></span><br><span class="line">        <span class="built_in">sort</span>(logs.<span class="built_in">begin</span>(), logs.<span class="built_in">end</span>(), compare);</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">parent</span><span class="params">(n, <span class="number">-1</span>)</span></span>;</span><br><span class="line">        set&lt;<span class="keyword">int</span>&gt; leaves;</span><br><span class="line">        set&lt;<span class="keyword">int</span>&gt; seen;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; logs.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> x = logs[i][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> y = logs[i][<span class="number">2</span>];</span><br><span class="line">            seen.<span class="built_in">insert</span>(x);</span><br><span class="line">            seen.<span class="built_in">insert</span>(y);</span><br><span class="line">            <span class="keyword">int</span> root = <span class="built_in">findRoot</span>(parent, x);</span><br><span class="line">            <span class="comment">// if root is itself, it is a leaf</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">findRoot</span>(parent,y) == root) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (x == root) &#123;</span><br><span class="line">                leaves.<span class="built_in">insert</span>(x);</span><br><span class="line">            &#125;</span><br><span class="line">            parent[root] = y;</span><br><span class="line">            leaves.<span class="built_in">erase</span>(y);</span><br><span class="line">            <span class="keyword">if</span> (seen.<span class="built_in">size</span>() == n) &#123;</span><br><span class="line">                <span class="keyword">int</span> curr_root = <span class="built_in">findRoot</span>(parent, <span class="number">0</span>);</span><br><span class="line">                <span class="keyword">bool</span> connected = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">auto</span> item: leaves) &#123;</span><br><span class="line">                    <span class="keyword">if</span>(curr_root!=<span class="built_in">findRoot</span>(parent, item))&#123;</span><br><span class="line">                        connected=<span class="literal">false</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (connected) &#123;</span><br><span class="line">                    <span class="keyword">return</span> logs[i][<span class="number">0</span>];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>After optimization:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; parent;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; rank;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findRoot</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="comment">// keep find next util curr is itself</span></span><br><span class="line">        <span class="keyword">if</span>(parent[x]==x) &#123;</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">findRoot</span>(parent[x]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">earliestAcq</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; &amp;logs, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// sort logs by time</span></span><br><span class="line">        <span class="comment">// init a parent array, every time we connect two people, we exec parent[root of i]=j</span></span><br><span class="line">        <span class="comment">// but we firstly check if i and j has been connected already.</span></span><br><span class="line">            <span class="comment">// namely find the root of j and compare it with root of i</span></span><br><span class="line">            <span class="comment">// if they equal, then they are connected.</span></span><br><span class="line">        <span class="comment">// we find root of i and parent[root]=j</span></span><br><span class="line">        <span class="built_in">sort</span>(logs.<span class="built_in">begin</span>(), logs.<span class="built_in">end</span>());</span><br><span class="line">        parent.<span class="built_in">resize</span>(n,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            parent[i]=i;</span><br><span class="line">        &#125;</span><br><span class="line">        rank.<span class="built_in">resize</span>(n,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> groups=n;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;logs.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x=logs[i][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> y=logs[i][<span class="number">2</span>];</span><br><span class="line">            <span class="keyword">int</span> rootx=<span class="built_in">findRoot</span>(x);</span><br><span class="line">            <span class="keyword">int</span> rooty=<span class="built_in">findRoot</span>(y);</span><br><span class="line">            <span class="keyword">if</span> (rootx==rooty) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// At first, there are n independent person. if two root are not equal, then merge two groups</span></span><br><span class="line">            <span class="comment">// when only 1 group left, all people are connected</span></span><br><span class="line">            <span class="comment">// let node with higher rank be the parent</span></span><br><span class="line">            <span class="keyword">if</span>(rank[rootx]==rank[rooty])&#123;</span><br><span class="line">                parent[rootx]=rooty;</span><br><span class="line">                rank[rooty]++;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(rank[rootx]&lt;rank[rooty])&#123;</span><br><span class="line">                parent[rootx]=rooty;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(rank[rootx]&gt;rank[rooty]) &#123;</span><br><span class="line">                parent[rooty]=rootx;</span><br><span class="line">            &#125;</span><br><span class="line">            groups--;</span><br><span class="line">            <span class="keyword">if</span>(groups==<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> logs[i][<span class="number">0</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// does not exist that time</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>If rooty is root, its rank will be increased.<br>Then it will be more likely to be parent. The graph looks like a star and the root is in the center.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2023/05/14/Longest%20Palindromic%20Substring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/14/Longest%20Palindromic%20Substring/" class="post-title-link" itemprop="url">Longest Palindromic Substring</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-05-14 00:00:00" itemprop="dateCreated datePublished" datetime="2023-05-14T00:00:00+08:00">2023-05-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-05-15 18:17:34" itemprop="dateModified" datetime="2023-05-15T18:17:34+08:00">2023-05-15</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Given a string <code>s</code>, return <em>the longest</em> </p>
<p><em>palindromic</em></p>
<p> <em>substring</em> in <code>s</code>.</p>
<p><strong>Example 1:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Input: s = &quot;babad&quot;</span><br><span class="line">Output: &quot;bab&quot;</span><br><span class="line">Explanation: &quot;aba&quot; is also a valid answer.</span><br></pre></td></tr></table></figure>

<p><strong>Example 2:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Input: s = &quot;cbbd&quot;</span><br><span class="line">Output: &quot;bb&quot;</span><br></pre></td></tr></table></figure>

<p><strong>Constraints:</strong></p>
<ul>
<li><code>1 &lt;= s.length &lt;= 1000</code></li>
<li><code>s</code> consist of only digits and English letters.</li>
</ul>
<p>This is my solution 1.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(string &amp;s, <span class="keyword">int</span> index, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//s[i]==s[s.size()-1-i]</span></span><br><span class="line">        <span class="comment">//s[0]==s[s.size()-1]</span></span><br><span class="line">        <span class="keyword">int</span> begin = index, end = index + len - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (begin &lt; end) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[begin] != s[end]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                begin++;</span><br><span class="line">                end--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">string <span class="title">longestPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// for each s[i,j], we judge if it is palindrome.</span></span><br><span class="line">        <span class="comment">// if it is palindrome, then compare it with previous max length.</span></span><br><span class="line">        <span class="keyword">int</span> maxm = <span class="number">1</span>;</span><br><span class="line">        string res;</span><br><span class="line">        <span class="keyword">int</span> start = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="comment">// if has got a palindrome, then the next must bigger than current</span></span><br><span class="line">            <span class="comment">// j means length of substring</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="built_in">max</span>(<span class="number">2</span>, maxm); i + j - <span class="number">1</span> &lt; s.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">isPalindrome</span>(s, i, j)) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (maxm &lt; j) &#123;</span><br><span class="line">                        start = i;</span><br><span class="line">                        maxm = j;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s.<span class="built_in">substr</span>(start, maxm);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>Although using dynamic programming costs more time in leetcode, i still consider it is a good idea. This solution is referring to a solution in leetcode. After understanding that solution, i try to write code from my memory to check if i really undertstand. But i found it is too hard to understand his loop variable. Thus i just follow my heart and use recursive to solve that problem.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">isPalindrome</span><span class="params">(<span class="keyword">int</span> dp[][<span class="number">1000</span>], <span class="keyword">int</span> i, <span class="keyword">int</span> j, string &amp;s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i == j) &#123;</span><br><span class="line">            dp[i][j] = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i + <span class="number">1</span> == j) &#123;</span><br><span class="line">            <span class="comment">// &#x27;bb&#x27;</span></span><br><span class="line">            dp[i][j] = s[i] == s[j];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (dp[i + <span class="number">1</span>][j - <span class="number">1</span>] == <span class="number">-1</span>) &#123;</span><br><span class="line">                dp[i][j] = s[i] == s[j] &amp;&amp; <span class="built_in">isPalindrome</span>(dp, i + <span class="number">1</span>, j - <span class="number">1</span>, s);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                dp[i][j] = s[i] == s[j] &amp;&amp; dp[i + <span class="number">1</span>][j - <span class="number">1</span>] == <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[i][j];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">string <span class="title">longestPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// init an array, dp[i][j]. </span></span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> dp[<span class="number">1000</span>][<span class="number">1000</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j++) &#123;</span><br><span class="line">                dp[i][j] = <span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// i means begin of the substring while j means end of the substring</span></span><br><span class="line">        <span class="comment">// dp[0][0]=true means s.substr(0,1) is palindrome</span></span><br><span class="line">        <span class="comment">// dp[0][3]=true means s.substr(0,4) is palindrome</span></span><br><span class="line">        <span class="comment">// dp[0][3]=s[0]==s[3] &amp;&amp; dp[1][2]</span></span><br><span class="line">        <span class="comment">// dp[1][2]=s[1]==s[2]</span></span><br><span class="line">        <span class="comment">// thus dp[i][j]=s[i]==s[j] &amp;&amp; dp[i+1][j-1], i+1 &lt;= j-1</span></span><br><span class="line">        <span class="comment">// we check all the possibilities of substring</span></span><br><span class="line">        <span class="keyword">int</span> max_len = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> max_begin = <span class="number">0</span>, max_end = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt; n; j++) &#123;</span><br><span class="line">                <span class="comment">// check if substring(i,j) is palindrome</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">isPalindrome</span>(dp, i, j, s)) &#123;</span><br><span class="line">                    <span class="keyword">int</span> curr_len = j - i + <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (curr_len &gt; max_len) &#123;</span><br><span class="line">                        max_len = curr_len;</span><br><span class="line">                        max_begin = i;</span><br><span class="line">                        max_end = j;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// record begin and end of the max substring</span></span><br><span class="line">        <span class="keyword">return</span> s.<span class="built_in">substr</span>(max_begin, max_end - max_begin + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<p>I guess it is the best solution. It is really efficient.</p>
<p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/longest-palindromic-substring/solutions/3401644/detailed-recursive-explaination-with-pictures-in-c-java-python-dp-two-pointers/">https://leetcode.com/problems/longest-palindromic-substring/solutions/3401644/detailed-recursive-explaination-with-pictures-in-c-java-python-dp-two-pointers/</a></p>
<p><img src="https://assets.leetcode.com/users/images/8e1ed821-5202-4801-9654-396e22b3f4ff_1681148824.1879745.png" alt="LPS0.png"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    string ans = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">expand</span><span class="params">(string &amp;s , <span class="keyword">int</span> left ,<span class="keyword">int</span> right)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(left &gt;= <span class="number">0</span> &amp;&amp;  right &lt; s.<span class="built_in">size</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s[left] != s[right])</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            left--,right++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(ans.<span class="built_in">size</span>() &lt; right - left )</span><br><span class="line">            ans = s.<span class="built_in">substr</span>(left + <span class="number">1</span> , right - left - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">string <span class="title">longestPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; s.<span class="built_in">size</span>() ; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">expand</span>(s , i , i);</span><br><span class="line">            <span class="built_in">expand</span>(s , i , i+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2023/05/13/COMP9315/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/05/13/COMP9315/" class="post-title-link" itemprop="url">COMP9315 DBMS Implementation</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2023-05-13 00:00:00 / Modified: 19:10:25" itemprop="dateCreated datePublished" datetime="2023-05-13T00:00:00+08:00">2023-05-13</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Since i have no course to choose, so i have to choose this one. On the other hand, this course can help me to understand better about database. Although this course is called Database Implementation, it does not teach you how to write a database application. Instead, the course is full of various algorithms, taking Postgre as example.</p>
<p>The quiz almost does not change every year. It aims to help you check whether you grasp the knowledge taught on lectures.</p>
<h1 id="Assessment-1"><a href="#Assessment-1" class="headerlink" title="Assessment 1"></a>Assessment 1</h1><p>For assessment 1, it needs you to implement a new type called gcoord. You can get more details on <a target="_blank" rel="noopener" href="https://cgi.cse.unsw.edu.au/~cs9315/23T1/assignment/1/index.php">https://cgi.cse.unsw.edu.au/~cs9315/23T1/assignment/1/index.php</a>.</p>
<p><strong>Note 1:</strong> </p>
<p>Because C Postgre library has special processing on struct storage. You should follow the document standard.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">GeoCoord</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">double</span> latitude_value;</span><br><span class="line">    <span class="keyword">double</span> longitude_value;</span><br><span class="line">    <span class="keyword">char</span> latitude_direction;</span><br><span class="line">    <span class="keyword">char</span> longitude_direction;</span><br><span class="line">    <span class="keyword">char</span> location_name[FLEXIBLE_ARRAY_MEMBER];</span><br><span class="line">&#125; GeoCoord;</span><br></pre></td></tr></table></figure>

<p>As shown above, variable-length variable must be declared at the end of the struct.</p>
<p>You can get more details on <a target="_blank" rel="noopener" href="https://www.postgresql.org/docs/current/xfunc-c.html">https://www.postgresql.org/docs/current/xfunc-c.html</a>.</p>
<p>Even though you don’t pay attention to this special usage,  <code>malloc</code> can also helps you pass lots of tests provided by the convener.</p>
<p><strong>Note 2:</strong></p>
<p>This problem is about precision. </p>
<p>For function Convert2DMS:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">It converts the greographical coordinates from decimal to DMS(degree, minute, second). The calculation can be described as:</span><br><span class="line">D = floor(Ddec),</span><br><span class="line">M = floor(60 × |Ddec-D|),</span><br><span class="line">S = floor(3600 × |Ddec-D| - 60 × M),</span><br></pre></td></tr></table></figure>

<p>Because latitude_value in my struct is double and double will cause precision loss when executing operation like:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> x = <span class="number">73.55</span>;</span><br><span class="line">    <span class="keyword">int</span> result = (<span class="keyword">int</span>)((x - <span class="number">73</span>) * <span class="number">60</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;result: %d&quot;</span>, result); <span class="comment">// result: 32</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The result should be 33 but program gives us 32.</p>
<p>Since the coordinate value do not have more than 4 decimal places, so we can solve it as shown below:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">myround</span><span class="params">(<span class="keyword">double</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> result = (x-round(x));</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">fabs</span>(result) &lt; <span class="number">0.0001</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> round(x);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DMS</span><span class="params">(<span class="keyword">char</span> *<span class="built_in">string</span>, <span class="keyword">double</span> value, <span class="keyword">char</span> direction)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> d_dec, degree, minute, second;</span><br><span class="line">    <span class="keyword">double</span> diff;</span><br><span class="line">    degree = (<span class="keyword">int</span>) <span class="built_in">floor</span>(value);</span><br><span class="line">    diff = (value - degree);</span><br><span class="line">    minute = (<span class="keyword">int</span>) <span class="built_in">floor</span>(myround(<span class="number">60</span>*diff));</span><br><span class="line">    second = (<span class="keyword">int</span>) <span class="built_in">floor</span>(myround(<span class="number">3600</span>*diff - <span class="number">60</span> * minute));</span><br><span class="line">    <span class="keyword">if</span> (minute == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">sprintf</span>(<span class="built_in">string</span>, <span class="string">&quot;%d°%c&quot;</span>, degree, direction);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (second == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="built_in">sprintf</span>(<span class="built_in">string</span>, <span class="string">&quot;%d°%d&#x27;%c&quot;</span>, degree, minute, direction);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">sprintf</span>(<span class="built_in">string</span>, <span class="string">&quot;%d°%d&#x27;%d\&quot;%c&quot;</span>, degree, minute, second, direction);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>But my friend has better idea:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">GeoCoord</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> latitude;</span><br><span class="line">  <span class="keyword">int</span> longitude;</span><br><span class="line">&#125;</span><br><span class="line">latitude = (<span class="keyword">int</span>)((x * <span class="number">10000</span>) + <span class="number">0.5</span>);</span><br><span class="line">longitude = (<span class="keyword">int</span>)((y * <span class="number">10000</span>) + <span class="number">0.5</span>);</span><br></pre></td></tr></table></figure>

<p><strong>Note 3:</strong></p>
<p>Because latitude and longitude in my struct are double and double is 64 bit. So we need 64-bit hash.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">uint32_t</span></span></span><br><span class="line"><span class="function"><span class="title">hash_uint64</span><span class="params">(<span class="keyword">uint64_t</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    key = (~key) + (key &lt;&lt; <span class="number">21</span>);</span><br><span class="line">    key = key ^ (key &gt;&gt; <span class="number">24</span>);</span><br><span class="line">    key = key + (key &lt;&lt; <span class="number">3</span>) + (key &lt;&lt; <span class="number">8</span>);</span><br><span class="line">    key = key ^ (key &gt;&gt; <span class="number">14</span>);</span><br><span class="line">    key = key + (key &lt;&lt; <span class="number">2</span>) + (key &lt;&lt; <span class="number">4</span>);</span><br><span class="line">    key = key ^ (key &gt;&gt; <span class="number">28</span>);</span><br><span class="line">    key = key + (key &lt;&lt; <span class="number">31</span>);</span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">uint32_t</span>)key;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PG_FUNCTION_INFO_V1(gcoord_hash);</span><br><span class="line"><span class="function">Datum</span></span><br><span class="line"><span class="function"><span class="title">gcoord_hash</span><span class="params">(PG_FUNCTION_ARGS)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    GeoCoord* coord = (GeoCoord*)PG_GETARG_POINTER(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">uint32_t</span> hash = <span class="number">0</span>;</span><br><span class="line">    hash ^= (<span class="keyword">uint32_t</span>) <span class="built_in">strlen</span>(coord-&gt;location_name);</span><br><span class="line">    hash ^= hash_uint64(coord-&gt;latitude_value);</span><br><span class="line">    hash ^= hash_uint64(coord-&gt;longitude_value);</span><br><span class="line">    hash ^= (<span class="keyword">uint32_t</span>) coord-&gt;latitude_direction;</span><br><span class="line">    PG_RETURN_UINT32(hash);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>I think it is too tricky and there should be a better solution.</p>
<h1 id="Assessment-2"><a href="#Assessment-2" class="headerlink" title="Assessment 2"></a>Assessment 2</h1><p>The second ass needs you to implement operation <code>Sel</code> and <code>Join</code>. You can find more details on <a target="_blank" rel="noopener" href="https://cgi.cse.unsw.edu.au/~cs9315/23T1/assignment/2/">https://cgi.cse.unsw.edu.au/~cs9315/23T1/assignment/2/</a>.</p>
<p><strong>Note1: read page from file</strong></p>
<p>You need to read page from file and for each page, you read tuple from it.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> page_idx = <span class="number">0</span>; page_idx &lt; total_page; page_idx++) &#123;</span><br><span class="line">  buffer* buffer_p = request_page(t, page_idx);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">int</span> tid = <span class="number">0</span>; tid &lt; get_tuples_num(buffer_p); tid++) &#123;</span><br><span class="line">    Tuple tuple = get_tuple_by_tuple_id(buffer_p, tid);</span><br><span class="line">    <span class="keyword">if</span> (tuple[idx] == cond_val) &#123;</span><br><span class="line">      result-&gt;tuples[counter++] = tuple;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">free</span>(tuple);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  release_page(buffer_p);</span><br><span class="line">  log_release_page(buffer_p-&gt;page_id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The thought seems simple but i didn’t come out at the beginning. I read all pages from files and then read tuples from pages.</p>
<p><strong>Note2: buffer pool</strong></p>
<p>Take <code>Sel</code> as example. We check whether current page is stored in buffer pool and if it has been stored, then just read it from pool. Otherwise, we read page from file by page index and then store the page in pool. When storing page in pool, we check whether the number of pages is greater than the buffer limit. If it is greater than buffer limit, then we use buffer replacement to replace page. Otherwise, we directly store the page in buffer pool.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">buffer* <span class="title">request_page</span><span class="params">(Table* t, <span class="keyword">int</span> page_index)</span> </span>&#123;</span><br><span class="line">    buffer* buffers = buffer_pool-&gt;buffers;</span><br><span class="line">    <span class="keyword">int</span> slot = page_in_pool(t-&gt;oid, page_index);</span><br><span class="line">    UINT buffer_size = buffer_pool-&gt;nbufs;</span><br><span class="line">    UINT* nvb_p = &amp;buffer_pool-&gt;nvb;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (slot &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        buffers[slot].usage++;</span><br><span class="line">        buffers[slot].pin = <span class="number">1</span>;</span><br><span class="line">        buffer_pool-&gt;nhits++;</span><br><span class="line">        <span class="keyword">return</span> &amp;buffers[slot];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (buffers[*nvb_p].pin == <span class="number">0</span> &amp;&amp; buffers[*nvb_p].usage == <span class="number">0</span>) &#123;</span><br><span class="line">            write_page_to_buffer_pool(t, *nvb_p, page_index);</span><br><span class="line">            UINT tmp = *nvb_p;</span><br><span class="line">            *nvb_p = (*nvb_p + <span class="number">1</span>) % buffer_size;</span><br><span class="line">            <span class="keyword">return</span> &amp;buffers[tmp];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (buffers[*nvb_p].usage &gt; <span class="number">0</span>) buffers[*nvb_p].usage--;</span><br><span class="line">            *nvb_p = (*nvb_p + <span class="number">1</span>) % buffer_size;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">write_page_to_buffer_pool</span><span class="params">(Table* t, UINT slot, UINT page_index)</span> </span>&#123;</span><br><span class="line">    FileInfo* file_info = open_file_by_table_name(t-&gt;name);</span><br><span class="line">    FILE* fp = file_info-&gt;file;</span><br><span class="line"></span><br><span class="line">    UINT page_size = get_conf()-&gt;page_size;</span><br><span class="line">    fseek(fp, page_index * page_size, SEEK_SET);</span><br><span class="line">    fread(buffer_pool-&gt;buffers[slot].page, page_size, <span class="number">1</span>, fp);</span><br><span class="line">    log_read_page(get_page_id(buffer_pool-&gt;buffers[slot].page));</span><br><span class="line"></span><br><span class="line">    buffer_pool-&gt;nreads++;</span><br><span class="line">    UINT64 page_id;</span><br><span class="line">    <span class="built_in">memcpy</span>(&amp;page_id, buffer_pool-&gt;buffers[slot].page, <span class="keyword">sizeof</span>(UINT64));</span><br><span class="line">    <span class="built_in">sprintf</span>(buffer_pool-&gt;buffers[slot].id, <span class="string">&quot;%u-%lu&quot;</span>, t-&gt;oid, page_id);</span><br><span class="line">    buffer_pool-&gt;buffers[slot].oid = t-&gt;oid;</span><br><span class="line">    <span class="built_in">memcpy</span>(buffer_pool-&gt;buffers[slot].table, t, <span class="keyword">sizeof</span>(Table));</span><br><span class="line">    buffer_pool-&gt;buffers[slot].page_index = page_index;</span><br><span class="line">    buffer_pool-&gt;buffers[slot].page_id = page_id;</span><br><span class="line">    buffer_pool-&gt;buffers[slot].usage = <span class="number">1</span>;</span><br><span class="line">    buffer_pool-&gt;buffers[slot].pin = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    release_file(file_info);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>For request_page, it implements the clock-sweep strategy which is the Postgre default buffer replacement policy.</p>
<p><strong>Note3: file pool</strong></p>
<p>Because we have the limit for the number of opened files. So we need to maintain a file pool.</p>
<p>If we want to read or write a page from file, we firstly check whether the file pointer has been stored in file pool by oid. If it has been stored, then we use it directly. Otherwise, we check whether the num of opened files is greater than the file limit. If it is greater than file limit, we use buffer replacement strategy the same as buffer pool. If not, we open a new file and store related oid in file pool.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">FileInfo* <span class="title">open_file_by_table_name</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* table_name)</span> </span>&#123;</span><br><span class="line">    Database* db = get_db();</span><br><span class="line">    Table* t = get_table(table_name);</span><br><span class="line">    <span class="keyword">char</span>* table_path = (<span class="keyword">char</span>*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(db-&gt;path) + <span class="number">5</span>);</span><br><span class="line">    <span class="built_in">sprintf</span>(table_path, <span class="string">&quot;%s/%u&quot;</span>, db-&gt;path, t-&gt;oid);</span><br><span class="line">    FileInfo* result = request_file(table_path, <span class="string">&quot;r&quot;</span>, t-&gt;oid);</span><br><span class="line">    <span class="built_in">free</span>(table_path);</span><br><span class="line">    <span class="built_in">free</span>(t);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">FileInfo* <span class="title">request_file</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* filename, <span class="keyword">const</span> <span class="keyword">char</span>* mode, UINT oid)</span> </span>&#123;</span><br><span class="line">    FileInfo* buffers = file_pool-&gt;buffers;</span><br><span class="line">    <span class="keyword">int</span> slot = file_in_pool(oid);</span><br><span class="line">    UINT buffer_size = file_pool-&gt;nbufs;</span><br><span class="line">    UINT* nvb_p = &amp;file_pool-&gt;nvb;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (slot &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">        buffers[slot].usage++;</span><br><span class="line">        buffers[slot].pin = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> &amp;buffers[slot];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (buffers[*nvb_p].pin == <span class="number">0</span> &amp;&amp; buffers[*nvb_p].usage == <span class="number">0</span>) &#123;</span><br><span class="line">            open_file_in_pool(*nvb_p, filename, mode, oid);</span><br><span class="line">            UINT tmp = *nvb_p;</span><br><span class="line">            *nvb_p = (*nvb_p + <span class="number">1</span>) % buffer_size;</span><br><span class="line">            <span class="keyword">return</span> &amp;buffers[tmp];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (buffers[*nvb_p].usage &gt; <span class="number">0</span>) buffers[*nvb_p].usage--;</span><br><span class="line">            *nvb_p = (*nvb_p + <span class="number">1</span>) % buffer_size;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">open_file_in_pool</span><span class="params">(UINT slot, <span class="keyword">const</span> <span class="keyword">char</span>* filename, <span class="keyword">const</span> <span class="keyword">char</span>* mode, UINT oid)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (file_pool-&gt;num_opened_files &gt;= file_pool-&gt;nbufs) &#123;</span><br><span class="line">        close_file_in_pool(slot);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    file_pool-&gt;buffers[slot].file = fopen(filename, mode);</span><br><span class="line">    log_open_file(oid);</span><br><span class="line">    file_pool-&gt;buffers[slot].oid = oid;</span><br><span class="line">    file_pool-&gt;buffers[slot].pin = <span class="number">1</span>;</span><br><span class="line">    file_pool-&gt;buffers[slot].usage = <span class="number">1</span>;</span><br><span class="line">    file_pool-&gt;num_opened_files++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Note4: valgrind</strong></p>
<p>The tool is used to check memory leak. It also can check error like:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span>* result = (<span class="keyword">char</span>*) <span class="built_in">malloc</span>(tuple_size);</span><br><span class="line"><span class="built_in">memcpy</span>(result, curr, tuple_size);</span><br><span class="line"></span><br><span class="line">Address <span class="number">0x4a40299</span> is <span class="number">0</span> bytes after a block of size <span class="number">25</span> alloc<span class="number">&#x27;</span>d</span><br></pre></td></tr></table></figure>

<p>For the code above, it should be written as below because the last byte is for <code>\0</code>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span>* result = (<span class="keyword">char</span>*) <span class="built_in">malloc</span>(tuple_size+<span class="number">1</span>);</span><br><span class="line"><span class="built_in">memcpy</span>(result, curr, tuple_size+<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h1 id="Final-exam"><a href="#Final-exam" class="headerlink" title="Final exam"></a>Final exam</h1><p>3 programs are all about assessment2. It is not difficult but it is really hard to figure it out in 3 hours because we have another 5 questions to do.</p>
<h2 id="Q1"><a href="#Q1" class="headerlink" title="Q1"></a><strong>Q1</strong></h2><p><strong>Note1: convert big tuple to small tuple</strong> </p>
<h2 id="Q2"><a href="#Q2" class="headerlink" title="Q2"></a>Q2</h2><p>I forgot to use <code>r+</code>. So funny…as a result, i write nothing back to the file.</p>
<h1 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h1><p>The course has challenging assessment. Ass1 strengthens my ability to collect information from official documents. Ass2 makes me have better understanding of clock sweep, simple hash join and merge sort join. It also enhances the ability to maintain C pointer.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2023/03/25/ANZAC_CONTEST_2023/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/03/25/ANZAC_CONTEST_2023/" class="post-title-link" itemprop="url">ANZAC CONTEST 2023</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2023-03-25 00:00:00" itemprop="dateCreated datePublished" datetime="2023-03-25T00:00:00+08:00">2023-03-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-05-18 16:21:05" itemprop="dateModified" datetime="2023-05-18T16:21:05+08:00">2023-05-18</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="A"><a href="#A" class="headerlink" title="A"></a>A</h1><p><img src="https://p.ipic.vip/e81xxn.png" alt="image-20230514013121971"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unordered_set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> N;</span><br><span class="line">    cin &gt;&gt; N;</span><br><span class="line">    <span class="comment">// init an unordered map.</span></span><br><span class="line">    unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; map;</span><br><span class="line">    unordered_set&lt;<span class="keyword">int</span>&gt; values;</span><br><span class="line">    map[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    map[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">// keep cal fib until if fib number &gt; N</span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">//cal fib util fib number &gt; N</span></span><br><span class="line">        <span class="keyword">int</span> fib = map[i - <span class="number">1</span>] + map[i - <span class="number">2</span>];</span><br><span class="line">        <span class="keyword">if</span> (fib &gt; N) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        map[i] = fib;</span><br><span class="line">        values.<span class="built_in">insert</span>(fib);</span><br><span class="line">        <span class="comment">//cal next</span></span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (values.<span class="built_in">count</span>(i)) &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;fizz&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cout &lt;&lt; <span class="string">&quot;buzz&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="B"><a href="#B" class="headerlink" title="B"></a>B</h1><p><img src="https://p.ipic.vip/ko3pol.png" alt="image-20230514013012760"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// input two numbers</span></span><br><span class="line">    <span class="comment">// first is the number to insert</span></span><br><span class="line">    <span class="comment">// second is the original number</span></span><br><span class="line">    <span class="comment">// our aim is to insert at a certain location to make the output biggest</span></span><br><span class="line">    <span class="comment">// find the first num that less than number to insert. 789 6-&gt;7896, 749 5-&gt;7549</span></span><br><span class="line">    <span class="comment">// 749 0-&gt;7490</span></span><br><span class="line">    <span class="comment">// 0 0 -&gt;0</span></span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    string number;</span><br><span class="line">    cin &gt;&gt; x;</span><br><span class="line">    cin &gt;&gt; number;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; result;</span><br><span class="line">    <span class="keyword">bool</span> inserted = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; number.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> curr = number[i] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (curr &lt;= x &amp;&amp; !inserted) &#123;</span><br><span class="line">            number.<span class="built_in">insert</span>(i, <span class="built_in">to_string</span>(x));</span><br><span class="line">            inserted = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        result.<span class="built_in">push_back</span>(curr);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!inserted) &#123;</span><br><span class="line">        number.<span class="built_in">push_back</span>(<span class="string">&#x27;0&#x27;</span> + x);</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; number &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><p>Take 20 as example:<br>20=17+3=13+7<br>17-3 has biggest diff.<br>14=11-3=8 step=1<br>8=5+3 step=2<br>5-3=2 step=3</p>
<p>First we has two pointers, left is 2 and right is x-1;<br>break: if left greater than right or left+right=x and right-left is even.<br>Then set x as right-left and loop again util right-left is 2 or 0.</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isPrime</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// divide num into 2 part like 11/2+1=6, i=[2,5]</span></span><br><span class="line">    <span class="comment">// 12/2+1=7,i=[2,6]</span></span><br><span class="line">    <span class="comment">// 1/2+1=1</span></span><br><span class="line">    <span class="keyword">if</span> (num==<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt; num / <span class="number">2</span> + <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (num % i == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getPrime</span><span class="params">(<span class="keyword">int</span> &amp;left, <span class="keyword">int</span> &amp;right, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//loop util right - left is even, otherwise right--.</span></span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="comment">//loop util right is prime</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">isPrime</span>(right)) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        left = x - right;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="built_in">isPrime</span>(left) || (right - left) % <span class="number">2</span> != <span class="number">0</span>) &#123;</span><br><span class="line">            right--;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    cin &gt;&gt; x;</span><br><span class="line">    <span class="keyword">int</span> steps = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">2</span>, right = x - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">getPrime</span>(left, right, x);</span><br><span class="line">        <span class="keyword">int</span> diff = right - left;</span><br><span class="line">        steps++;</span><br><span class="line">        <span class="keyword">if</span> (diff == <span class="number">0</span> || diff == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            x = diff;</span><br><span class="line">            right = x - <span class="number">1</span>;</span><br><span class="line">            left = <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; steps;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h1 id="H"><a href="#H" class="headerlink" title="H"></a>H</h1><p><img src="https://p.ipic.vip/jtxhry.png" alt="image-20230514013149755"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2021/09/02/9.2_%E4%B8%8A%E6%B5%B7%E9%BC%8E%E7%AD%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/02/9.2_%E4%B8%8A%E6%B5%B7%E9%BC%8E%E7%AD%96/" class="post-title-link" itemprop="url">上海鼎策</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-02 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-02T00:00:00+08:00">2021-09-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-05-13 17:27:59" itemprop="dateModified" datetime="2023-05-13T17:27:59+08:00">2023-05-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="银行贷款，分期归还"><a href="#银行贷款，分期归还" class="headerlink" title="银行贷款，分期归还"></a>银行贷款，分期归还</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Double&gt; <span class="title">getRepayment</span><span class="params">(Double allMoney,<span class="keyword">int</span> numberOfMonths)</span> </span>&#123;</span><br><span class="line">    Double money = allMoney / numberOfMonths;</span><br><span class="line">    List&lt;Double&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;numberOMonths-<span class="number">1</span>;i++) &#123;</span><br><span class="line">        res.add(money);</span><br><span class="line">    &#125;</span><br><span class="line">    Double lastMonthMoney = allMoney - (numberOfMonths-<span class="number">1</span>)*money;</span><br><span class="line">    res.add(lastMonthMoney);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>考虑小数问题</p>
<h2 id="归笼与未归笼"><a href="#归笼与未归笼" class="headerlink" title="归笼与未归笼"></a>归笼与未归笼</h2><p>如果0&lt;count&lt;total，就是部分归笼，count=0就是未归笼，count=total就是归笼。要求编写sql语句达成如下效果：</p>
<p>原表：</p>
<img src="https://p.ipic.vip/kn66dj.png" alt="image-20230513192643628" style="zoom: 33%;" />

<p>经过查询输出：</p>
<img src="https://p.ipic.vip/47kxor.png" alt="image-20230513192719499" style="zoom:50%;" />

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database ShangHaiDingCe;</span><br><span class="line"></span><br><span class="line">use ShangHaiDingCe;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> sheep;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> sheep (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    total <span class="type">int</span>,</span><br><span class="line">    number <span class="type">int</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> sheep (id, total, number) <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="number">10</span>,<span class="number">4</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> sheep (id, total, number) <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="number">10</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> sheep (id, total, number) <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="number">10</span>,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> sheep (id, total, number) <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="number">10</span>,<span class="number">8</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> sheep (id, total, number) <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="number">10</span>,<span class="number">7</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> sheep (id, total, number) <span class="keyword">values</span> (<span class="keyword">null</span>,<span class="number">10</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> sheep;</span><br></pre></td></tr></table></figure>





<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> id,total,number,</span><br><span class="line">       <span class="keyword">case</span></span><br><span class="line">            <span class="keyword">when</span> number<span class="operator">=</span><span class="number">0</span> <span class="keyword">then</span> <span class="string">&#x27;未归笼&#x27;</span></span><br><span class="line">            <span class="keyword">when</span> number<span class="operator">=</span>total <span class="keyword">then</span> <span class="string">&#x27;归笼&#x27;</span></span><br><span class="line">            <span class="keyword">else</span> <span class="string">&#x27;部分归笼&#x27;</span></span><br><span class="line">       <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">as</span> <span class="string">&#x27;STATUS&#x27;</span></span><br><span class="line"><span class="keyword">from</span> sheep;</span><br></pre></td></tr></table></figure>



<h2 id="linux解压命令"><a href="#linux解压命令" class="headerlink" title="linux解压命令"></a>linux解压命令</h2><p> tar -zxv -f apache-tomcat-8.0.29.tar.gz </p>
<h2 id="部署tomcat服务器"><a href="#部署tomcat服务器" class="headerlink" title="部署tomcat服务器"></a>部署tomcat服务器</h2><p><strong>方法一：</strong></p>
<p>解压tomcat <code>tar -zxv -f apache-tomcat-8.0.29.tar.gz </code></p>
<p>进入tomcat目录</p>
<p>开放端口8080</p>
<p>启动tomcat <code>./tomcat/bin/start.sh </code></p>
<p>可以通过ip:8080访问tomcat主页</p>
<p>war包通过xftp上传到webapps下</p>
<p>可以通过ip:8080/war包名称访问项目</p>
<p><strong>方法二：</strong></p>
<p>解压tomcat</p>
<p>开放端口</p>
<p>将tomcat配置为系统服务</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#创建Tomcat8服务文件</span></span><br><span class="line">$ vi /usr/lib/systemd/system/tomcat8.service</span><br><span class="line"></span><br><span class="line"><span class="comment">#tomcat8.service文件内容：</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=Tomcat8</span><br><span class="line">After=syslog.target network.target remote-fs.target nss-lookup.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line"></span><br><span class="line">ExecStart=/usr/tomcat/tomcat8/bin/startup.sh</span><br><span class="line">ExecReload=/usr/tomcat/tomcat8/bin/startup.sh</span><br><span class="line">ExecStop=/usr/tomcat/tomcat8/bin/shutdown.sh</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#设置Tomcat8开机启动</span></span><br><span class="line">$ systemctl <span class="built_in">enable</span> tomcat8</span><br><span class="line"></span><br><span class="line"><span class="comment">#启动tomcat8服务</span></span><br><span class="line">$ systemctl start tomcat8</span><br></pre></td></tr></table></figure>



<h2 id="实时查看tomcat日志"><a href="#实时查看tomcat日志" class="headerlink" title="实时查看tomcat日志"></a>实时查看tomcat日志</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2021/09/01/9.1_%E6%9D%AD%E5%BC%80%E7%8E%AF%E5%A2%83/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/01/9.1_%E6%9D%AD%E5%BC%80%E7%8E%AF%E5%A2%83/" class="post-title-link" itemprop="url">杭开环境</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-09-01 00:00:00" itemprop="dateCreated datePublished" datetime="2021-09-01T00:00:00+08:00">2021-09-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-05-12 21:59:08" itemprop="dateModified" datetime="2023-05-12T21:59:08+08:00">2023-05-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="mybatis-动态sql"><a href="#mybatis-动态sql" class="headerlink" title="mybatis 动态sql"></a>mybatis 动态sql</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;findActiveBlogWithTitleLike&quot; parameterType<span class="operator">=</span>&quot;Blog&quot; resultType<span class="operator">=</span>&quot;Blog&quot;<span class="operator">&gt;</span></span><br><span class="line">  <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> BLOG <span class="keyword">WHERE</span> state <span class="operator">=</span> ‘ACTIVE’</span><br><span class="line">  <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;title != null and title != &#x27;&#x27;&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">AND</span> title <span class="keyword">like</span> #&#123;title&#125;</span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="mybatis-xml有哪些标签"><a href="#mybatis-xml有哪些标签" class="headerlink" title="mybatis xml有哪些标签"></a>mybatis xml有哪些标签</h2><p> <code>&lt;select&gt;</code></p>
<p><code>delete</code></p>
<p><code>update</code></p>
<p><strong>动态SQL</strong></p>
<p><code>choose</code></p>
<p><code>if</code></p>
<p><code>when</code></p>
<p><code>otherwise</code></p>
<p><code>set</code></p>
<h2 id="两个用户同时下订单"><a href="#两个用户同时下订单" class="headerlink" title="两个用户同时下订单"></a>两个用户同时下订单</h2><h2 id="redis取出自定义对象直接转换"><a href="#redis取出自定义对象直接转换" class="headerlink" title="redis取出自定义对象直接转换"></a>redis取出自定义对象直接转换</h2><h2 id="redis在现实中的应用"><a href="#redis在现实中的应用" class="headerlink" title="redis在现实中的应用"></a>redis在现实中的应用</h2><p>购物车</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2021/08/31/8.31_%E9%B9%8F%E4%BF%A1%E7%A7%91%E6%8A%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/31/8.31_%E9%B9%8F%E4%BF%A1%E7%A7%91%E6%8A%80/" class="post-title-link" itemprop="url">鹏信科技</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-08-31 00:00:00" itemprop="dateCreated datePublished" datetime="2021-08-31T00:00:00+08:00">2021-08-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-05-13 17:31:09" itemprop="dateModified" datetime="2023-05-13T17:31:09+08:00">2023-05-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="村民-干部"><a href="#村民-干部" class="headerlink" title="村民 干部"></a>村民 干部</h2><p>今天的面试题:<br>村里新来一位干部，5位村民分别听到关于这位干部的如下情况：</p>
<p>(1)姓莫，中年，女干部，精通会计;</p>
<p>(2)姓徐，中年，男干部，懂建筑设计;</p>
<p>(3)姓刘，青年，男干部，熟悉农业生产技术;</p>
<p>(4)姓吕，青年，男干部，懂建筑设计;</p>
<p>(5)姓莫，老年，男干部，熟悉农业生产技术。</p>
<p>每位村民听到的四项情况中各只有一项正确。这位新来的干部是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">假设精通农业，则不姓刘、莫，不为青、老，不为男，</span><br><span class="line">	则姓徐、吕，为中，为女</span><br><span class="line">	则为徐中女、吕中女，则(1)命中2个条件，不符合</span><br><span class="line">	</span><br><span class="line">假设精通建筑，则不姓徐、吕，不为中、青，不为男，</span><br><span class="line">	则姓刘、莫，为老，为女</span><br><span class="line">	则为刘老女、莫老女，</span><br><span class="line">	莫老女时，(5)命中2个条件，不符合</span><br><span class="line">	刘老女时，符合</span><br></pre></td></tr></table></figure>



<h2 id="计算字符出现的次数，字符之间用分号间隔"><a href="#计算字符出现的次数，字符之间用分号间隔" class="headerlink" title="计算字符出现的次数，字符之间用分号间隔"></a>计算字符出现的次数，字符之间用分号间隔</h2><p>例如HelloWorld，输出H-1;e-1;l-3;o-2;d-1</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">countAndPrint</span><span class="params">(String input)</span> </span>&#123;</span><br><span class="line">        Map&lt;Character, Integer&gt; map = <span class="keyword">new</span> LinkedHashMap&lt;&gt;();</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">// 计数</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; input.length(); i++) &#123;</span><br><span class="line">            Character ch = input.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (!map.containsKey(ch)) &#123;</span><br><span class="line">                map.put(ch, <span class="number">1</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                map.put(ch, map.get(ch) + <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 遍历map并添加到list中</span></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;Character, Integer&gt; entry : map.entrySet()) &#123;</span><br><span class="line">            list.add(entry.getKey() + <span class="string">&quot;-&quot;</span> + entry.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">        String res = StringUtils.join(list, <span class="string">&quot;;&quot;</span>);</span><br><span class="line">        System.out.println(res);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        countAndPrint(<span class="string">&quot;HelloWorld&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为要顺序的输出，所以用到LinkedHashMap</p>
<p>方法二：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">countAndPrint2</span><span class="params">(String input)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">int</span> len = (<span class="keyword">int</span>) <span class="string">&#x27;z&#x27;</span>;</span><br><span class="line"></span><br><span class="line">       <span class="comment">// 默认初始化为0</span></span><br><span class="line">       <span class="keyword">int</span>[] num = <span class="keyword">new</span> <span class="keyword">int</span>[len];</span><br><span class="line">       Set&lt;Character&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">       List&lt;String&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; input.length(); i++) &#123;</span><br><span class="line">           <span class="keyword">char</span> ch = input.charAt(i);</span><br><span class="line">           num[ch] += <span class="number">1</span>;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; input.length(); i++) &#123;</span><br><span class="line">           <span class="keyword">char</span> ch = input.charAt(i);</span><br><span class="line">           <span class="keyword">if</span> (!set.contains(ch)) &#123;</span><br><span class="line">               list.add(ch + <span class="string">&quot;-&quot;</span> + num[ch]);</span><br><span class="line">           &#125;</span><br><span class="line">           set.add(ch);</span><br><span class="line">       &#125;</span><br><span class="line">       String res = StringUtils.join(list, <span class="string">&quot;;&quot;</span>);</span><br><span class="line">       System.out.println(res);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h2 id="redis的数据类型"><a href="#redis的数据类型" class="headerlink" title="redis的数据类型"></a>redis的数据类型</h2><p>List、Hash、Set</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建并初始化</span></span><br><span class="line">$ LPUSH list1 5 6 7 8 9</span><br><span class="line"><span class="comment"># 输出</span></span><br><span class="line">$ LRANGE list1 0 -1</span><br><span class="line">9</span><br><span class="line">8</span><br><span class="line">7</span><br><span class="line">6</span><br><span class="line">5</span><br></pre></td></tr></table></figure>

<h3 id="list"><a href="#list" class="headerlink" title="list"></a>list</h3><p>list是一个栈，操作是lpush、rpush、lpop、rpop</p>
<p>lpush表示list push、lrange表示list range</p>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">set</span> username naruto</span><br><span class="line">$ get username</span><br><span class="line">naruto</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="hmset-表示hash-multiple-set"><a href="#hmset-表示hash-multiple-set" class="headerlink" title="hmset 表示hash multiple set"></a>hmset 表示hash multiple set</h3><p>可以一次插入多个键值对</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建并初始化</span></span><br><span class="line">$ hmset student01 name <span class="string">&quot;naruto&quot;</span> age 18</span><br><span class="line"><span class="comment"># 获取键值</span></span><br><span class="line">$ hget student01 name</span><br></pre></td></tr></table></figure>



<h3 id="hset-表示hash-set"><a href="#hset-表示hash-set" class="headerlink" title="hset 表示hash set"></a>hset 表示hash set</h3><p>与hmset相比，一次只能插入一个键值对</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建并初始化</span></span><br><span class="line">$ hset student01 name <span class="string">&quot;naruto&quot;</span></span><br><span class="line">$ hset student02 age 18</span><br><span class="line"><span class="comment"># 获取键值</span></span><br><span class="line">$ hget student01 name</span><br></pre></td></tr></table></figure>

<h3 id="set-表示无序集合"><a href="#set-表示无序集合" class="headerlink" title="set 表示无序集合"></a>set 表示无序集合</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd student_name naruto</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd student_name <span class="string">&quot;sasuke&quot;</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd student_name sakura</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; smembers student_name</span><br><span class="line">1) <span class="string">&quot;sakura&quot;</span></span><br><span class="line">2) <span class="string">&quot;naruto&quot;</span></span><br><span class="line">3) <span class="string">&quot;sasuke&quot;</span></span><br></pre></td></tr></table></figure>

<p>可以看到并没有按照我们添加的顺序进行打印，所以是无序集合</p>
<h3 id="zset-表示有序集合"><a href="#zset-表示有序集合" class="headerlink" title="zset 表示有序集合"></a>zset 表示有序集合</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; zadd roles 1 大蛇</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd roles 2 八神奄</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd roles 2 隆</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; zadd roles 3 草薙京</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; zrange roles 0 10</span><br><span class="line">大蛇</span><br><span class="line">八神奄</span><br><span class="line">隆</span><br><span class="line">草薙京</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; zrange roles 0 10 withscores</span><br><span class="line">大蛇</span><br><span class="line">1</span><br><span class="line">八神奄</span><br><span class="line">2</span><br><span class="line">隆</span><br><span class="line">2</span><br><span class="line">草薙京</span><br><span class="line">3</span><br></pre></td></tr></table></figure>





<h2 id="hashmap的属性"><a href="#hashmap的属性" class="headerlink" title="hashmap的属性"></a>hashmap的属性</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">int</span> threshold;</span><br><span class="line"><span class="comment">// 存放键值对</span></span><br><span class="line"><span class="keyword">transient</span> Node&lt;K,V&gt;[] table;</span><br><span class="line"></span><br><span class="line">The number of key-value mappings contained in <span class="keyword">this</span> map.</span><br><span class="line"><span class="keyword">transient</span> <span class="keyword">int</span> size;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 是缓存</span></span><br><span class="line"><span class="comment">// Holds cached entrySet(). Note that AbstractMap fields are used for keySet() and values().</span></span><br><span class="line"><span class="keyword">transient</span> Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;</span><br></pre></td></tr></table></figure>

<p>threshold阈值</p>
<p>threshold表示当HashMap的size大于threshold时会执行resize操作。<br>threshold=capacity*loadFactor</p>
<h2 id="hashmap的方法"><a href="#hashmap的方法" class="headerlink" title="hashmap的方法"></a>hashmap的方法</h2><p>isEmpty()</p>
<p>containsKey()，containsValue()</p>
<p>entrySet()</p>
<p>put()</p>
<p>putAll()</p>
<p>remove()</p>
<p>keys()，values()</p>
<p>clear()</p>
<p>get()</p>
<h2 id="hashmap用到的设计模式"><a href="#hashmap用到的设计模式" class="headerlink" title="hashmap用到的设计模式"></a>hashmap用到的设计模式</h2><p>Nodes</p>
<p>组合模式、代理模式</p>
<h3 id="composite"><a href="#composite" class="headerlink" title="composite"></a>composite</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lin.composite;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">OrganizationComponmet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String des;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(OrganizationComponmet organizationComponmet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(OrganizationComponmet organizationComponmet)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">OrganizationComponmet</span><span class="params">(String name, String des)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.des = des;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> des;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDes</span><span class="params">(String des)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.des = des;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>;</span><br><span class="line">       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="University"><a href="#University" class="headerlink" title="University"></a>University</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lin.composite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">University</span> <span class="keyword">extends</span> <span class="title">OrganizationComponmet</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    List&lt;OrganizationComponmet&gt; organizationComponmets = <span class="keyword">new</span> ArrayList&lt;OrganizationComponmet&gt;();</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">University</span><span class="params">(String name, String des)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, des);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(OrganizationComponmet organizationComponmet)</span> </span>&#123;</span><br><span class="line">        organizationComponmets.add(organizationComponmet);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(OrganizationComponmet organizationComponmet)</span> </span>&#123;</span><br><span class="line">        organizationComponmets.remove(organizationComponmet);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getDes();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.getName();</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span> + getName() + <span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (OrganizationComponmet organizationComponmet : organizationComponmets) &#123;</span><br><span class="line">            organizationComponmet.print();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="College"><a href="#College" class="headerlink" title="College"></a>College</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lin.composite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">College</span> <span class="keyword">extends</span> <span class="title">OrganizationComponmet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">List&lt;OrganizationComponmet&gt; organizationComponmets = <span class="keyword">new</span> ArrayList&lt;OrganizationComponmet&gt;();</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">College</span><span class="params">(String name, String des)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, des);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(OrganizationComponmet organizationComponmet)</span> </span>&#123;</span><br><span class="line">        organizationComponmets.add(organizationComponmet);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">remove</span><span class="params">(OrganizationComponmet organizationComponmet)</span> </span>&#123;</span><br><span class="line">        organizationComponmets.remove(organizationComponmet);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getDes();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.getName();</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">        System.out.println(<span class="string">&quot;---------------------&quot;</span> + getName() + <span class="string">&quot;--------------------&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> (OrganizationComponmet organizationComponmet : organizationComponmets) &#123;</span><br><span class="line">            organizationComponmet.print();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Department"><a href="#Department" class="headerlink" title="Department"></a>Department</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lin.composite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Department</span> <span class="keyword">extends</span> <span class="title">OrganizationComponmet</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Department</span><span class="params">(String name, String des)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(name, des);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getDes</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getDes();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.getName();</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(getName());</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Client"><a href="#Client" class="headerlink" title="Client"></a>Client</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.lin.composite;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        OrganizationComponmet university = <span class="keyword">new</span> University(<span class="string">&quot;波大&quot;</span>, <span class="string">&quot;美国大学&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        OrganizationComponmet college1 = <span class="keyword">new</span> College(<span class="string">&quot;计算机学院&quot;</span>, <span class="string">&quot;计算机&quot;</span>);</span><br><span class="line">        OrganizationComponmet college2 = <span class="keyword">new</span> College(<span class="string">&quot;中文学院&quot;</span>, <span class="string">&quot;中文&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        university.add(college1);</span><br><span class="line">        university.add(college2);</span><br><span class="line">        </span><br><span class="line">        OrganizationComponmet department1 = <span class="keyword">new</span> Department(<span class="string">&quot;软件工程专业&quot;</span>, <span class="string">&quot;软件&quot;</span>);</span><br><span class="line">        OrganizationComponmet department2 = <span class="keyword">new</span> Department(<span class="string">&quot;大数据专业&quot;</span>, <span class="string">&quot;大数据&quot;</span>);</span><br><span class="line">        OrganizationComponmet department3 = <span class="keyword">new</span> Department(<span class="string">&quot;汉语言专业&quot;</span>, <span class="string">&quot;汉语言&quot;</span>);</span><br><span class="line">        OrganizationComponmet department4 = <span class="keyword">new</span> Department(<span class="string">&quot;中华文化专业&quot;</span>, <span class="string">&quot;中华文化&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        college1.add(department1);</span><br><span class="line">        college1.add(department2);</span><br><span class="line">        college2.add(department3);</span><br><span class="line">        college2.add(department4);</span><br><span class="line">        </span><br><span class="line">        university.print();</span><br><span class="line">        System.out.println(<span class="string">&quot;--------------------------------------------&quot;</span>);</span><br><span class="line">        college1.print();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p><img src="https://p.ipic.vip/sk2cbk.jpg" alt="74922d10b7121f73e972951901eb44c2"></p>
<p><img src="https://p.ipic.vip/x26tn2.jpg" alt="92205c7628d7b345f2b6e6f2a17e21e2"></p>
<p>Map的put、putall交给AbstractHashMap实现，再交给HashMap实现，而结点的管理交给Node来实现。</p>
<h3 id="什么是组合模式？"><a href="#什么是组合模式？" class="headerlink" title="什么是组合模式？"></a>什么是组合模式？</h3><p>大部分国家的军队都采用层次结构管理。 每支部队包括几个师， 师由旅构成， 旅由团构成， 团可以继续划分为排。 最后， 每个排由一小队实实在在的士兵组成。 军事命令由最高层下达， 通过每个层级传递， 直到每位士兵都知道自己应该服从的命令。</p>
<img src="https://p.ipic.vip/e3fx1k.jpg" alt="0d636cc347c14d64bac869bfc7d49268" style="zoom: 33%;" />

<ol>
<li><p><strong>组件</strong> （Component） 接口描述了树中简单项目和复杂项目所共有的操作。</p>
</li>
<li><p><strong>叶节点</strong> （Leaf） 是树的基本结构， 它不包含子项目。</p>
<p> 一般情况下， 叶节点最终会完成大部分的实际工作， 因为它们无法将工作指派给其他部分。</p>
</li>
<li><p><strong>容器</strong> （Container）——又名 “组合 （Composite）”——是包含叶节点或其他容器等子项目的单位。 容器不知道其子项目所属的具体类， 它只通过通用的组件接口与其子项目交互。</p>
<p> 容器接收到请求后会将工作分配给自己的子项目， 处理中间结果， 然后将最终结果返回给客户端。</p>
</li>
<li><p><strong>客户端</strong> （Client） 通过组件接口与所有项目交互。 因此， 客户端能以相同方式与树状结构中的简单或复杂项目交互。</p>
</li>
</ol>
<p>而Map也是一样，先让AbstractHashMap完成一些事情，再将剩下的任务交给HashMap完成，HashMap又将一部分任务交给Node完成，Node是容器。</p>
<h2 id="和-的区别"><a href="#和-的区别" class="headerlink" title="${}和#{}的区别"></a>${}和#{}的区别</h2><p>#{}是预编译，${}是字符串替换</p>
<h2 id="mybatis有什么好处"><a href="#mybatis有什么好处" class="headerlink" title="mybatis有什么好处"></a>mybatis有什么好处</h2><ul>
<li>sql参数注入、返回</li>
<li>动态sql</li>
</ul>
<h2 id="mybatis注入支持的数据类型"><a href="#mybatis注入支持的数据类型" class="headerlink" title="mybatis注入支持的数据类型"></a>mybatis注入支持的数据类型</h2><p>基本数据类型：整型、浮点、字符串</p>
<p>复杂数据类型：Map、引用</p>
<table>
<thead>
<tr>
<th>java</th>
<th>sql</th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>String</td>
<td>varchar</td>
<td></td>
</tr>
<tr>
<td>Integer</td>
<td>Integer</td>
<td></td>
</tr>
<tr>
<td>BigDecimal</td>
<td>numeric</td>
<td></td>
</tr>
<tr>
<td>date</td>
<td>date</td>
<td></td>
</tr>
<tr>
<td>calendar</td>
<td>timestamp</td>
<td></td>
</tr>
<tr>
<td>byte[]</td>
<td>blob</td>
<td></td>
</tr>
<tr>
<td>Double</td>
<td>double</td>
<td></td>
</tr>
</tbody></table>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里parameterType是Map</span></span><br><span class="line">&lt;sql id=<span class="string">&quot;Base_Column_List&quot;</span> &gt; </span><br><span class="line"> id, car_dept_name, car_maker_name, icon,car_maker_py,hot_type </span><br><span class="line"> &lt;/sql&gt; </span><br><span class="line"> &lt;select id=<span class="string">&quot;selectByPrimaryKey&quot;</span> resultMap=<span class="string">&quot;BaseResultMap&quot;</span> parameterType=<span class="string">&quot;java.lang.Long&quot;</span> &gt; </span><br><span class="line"> select </span><br><span class="line"> &lt;include refid=<span class="string">&quot;Base_Column_List&quot;</span> /&gt; </span><br><span class="line"> from common_car_make </span><br><span class="line"> where id = #&#123;id,jdbcType=BIGINT&#125; </span><br><span class="line"> &lt;/select&gt; </span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// parameterType是自定义引用类型</span></span><br><span class="line">&lt;update id=<span class="string">&quot;updateByPrimaryKeySelective&quot;</span> parameterType=<span class="string">&quot;com.illuca.entity.Student&quot;</span> &gt; </span><br><span class="line"> update student </span><br><span class="line"> &lt;set &gt; </span><br><span class="line">  &lt;<span class="keyword">if</span> test=<span class="string">&quot;studentName != null&quot;</span> &gt; </span><br><span class="line">  student_name = #&#123;studentName,jdbcType=VARCHAR&#125;, </span><br><span class="line">  &lt;/<span class="keyword">if</span>&gt; </span><br><span class="line">  &lt;<span class="keyword">if</span> test=<span class="string">&quot;score != null&quot;</span> &gt; </span><br><span class="line">  score = #&#123;score,jdbcType=VARCHAR&#125;</span><br><span class="line"> &lt;/set&gt; </span><br><span class="line"> where student_id = #&#123;studentId,jdbcType=BIGINT&#125; </span><br><span class="line"> &lt;/update&gt; </span><br></pre></td></tr></table></figure>

<h2 id="删除A中存在但B中不存在的记录"><a href="#删除A中存在但B中不存在的记录" class="headerlink" title="删除A中存在但B中不存在的记录"></a>删除A中存在但B中不存在的记录</h2><p>delete from A where tagetColumn not in ( select targetColumn from B)</p>
<h2 id="网关解决什么问题？什么是熔断？"><a href="#网关解决什么问题？什么是熔断？" class="headerlink" title="网关解决什么问题？什么是熔断？"></a>网关解决什么问题？什么是熔断？</h2><p>解决路由问题</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://illuca.github.io/2021/08/30/8.30_%E9%9D%A2%E8%AF%95%E4%B8%8A%E6%B5%B7%E5%90%8C%E4%BD%99%E7%A7%91%E6%8A%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="illuca">
      <meta itemprop="description" content="illuca 's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="illuca">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/08/30/8.30_%E9%9D%A2%E8%AF%95%E4%B8%8A%E6%B5%B7%E5%90%8C%E4%BD%99%E7%A7%91%E6%8A%80/" class="post-title-link" itemprop="url">同余科技</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-08-30 00:00:00" itemprop="dateCreated datePublished" datetime="2021-08-30T00:00:00+08:00">2021-08-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-05-12 21:59:08" itemprop="dateModified" datetime="2023-05-12T21:59:08+08:00">2023-05-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="多线程在项目中有运用么？"><a href="#多线程在项目中有运用么？" class="headerlink" title="多线程在项目中有运用么？"></a>多线程在项目中有运用么？</h2><h2 id="后端单元测试包，生成假数据"><a href="#后端单元测试包，生成假数据" class="headerlink" title="后端单元测试包，生成假数据"></a>后端单元测试包，生成假数据</h2><p>Mock</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> WebApplicationContext webApplicationContext;</span><br><span class="line"><span class="keyword">private</span> MockMvc mockMvc;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在每个测试方法执行之前都初始化MockMvc对象</span></span><br><span class="line"><span class="meta">@BeforeEach</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setupMockMvc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    mockMvc = MockMvcBuilders.webAppContextSetup(webApplicationContext).build();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DisplayName(&quot;测试根据Id获取User&quot;)</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//perform,执行一个RequestBuilders请求，会自动执行SpringMVC的流程并映射到相应的控制器执行处理</span></span><br><span class="line">    mockMvc.perform(MockMvcRequestBuilders</span><br><span class="line">        <span class="comment">//构造一个get请求</span></span><br><span class="line">        .get(<span class="string">&quot;/user/1&quot;</span>)</span><br><span class="line">        <span class="comment">//请求类型 json</span></span><br><span class="line">        .contentType(MediaType.APPLICATION_JSON))</span><br><span class="line">        <span class="comment">// 期待返回的状态码是4XX，因为我们并没有写/user/&#123;id&#125;的get接口</span></span><br><span class="line">        .andExpect(MockMvcResultMatchers.status().is4xxClientError());</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="jwt在项目中应用"><a href="#jwt在项目中应用" class="headerlink" title="jwt在项目中应用"></a>jwt在项目中应用</h2><p>生成token</p>
<p>TOKEN分为3个部分=头部 负载  签证</p>
<p>头部声明jwt和所用算法</p>
<p>负载包含用户信息</p>
<p>用加密算法生成signature</p>
<h2 id="nacos作用"><a href="#nacos作用" class="headerlink" title="nacos作用"></a>nacos作用</h2><p>负载均衡 注册中心 </p>
<h2 id="redis项目中应用"><a href="#redis项目中应用" class="headerlink" title="redis项目中应用"></a>redis项目中应用</h2><h2 id="单点登录"><a href="#单点登录" class="headerlink" title="单点登录"></a>单点登录</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">illuca</p>
  <div class="site-description" itemprop="description">illuca 's Blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">19</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">illuca</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
